<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="/static/styles.css">
    <title>Car Data</title>
</head>
<body class="{{if .CarData.IsPopup}}popup-bg{{else}}{{end}}">
    <h1>Car Data</h1>

    <!-- HTML Form for Filtering -->

    <form method="get" action="/filtered">
        <label for="manufacturer">Manufacturer:</label>
        <select name="manufacturer">
            <option value="">All</option>
            {{range .CarData.Manufacturers}}
            <option value="{{.Name}}">{{.Name}}</option>
            {{end}}
        </select>

        <label for="category">Category:</label>
        <select name="category">
            <option value="">All</option>
            {{range .CarData.Categories}}
            <option value="{{.Name}}">{{.Name}}</option>
            {{end}}
        </select>

        <label for="drivetrain">Drivetrain:</label>
        <select name="drivetrain">
            <option value="">All</option>
            <option value="Front-Wheel Drive">Front-Wheel Drive</option>
            <option value="Rear-Wheel Drive">Rear-Wheel Drive</option>
            <option value="All-Wheel Drive">All-Wheel Drive</option>
        </select>

        <label for="transmission">Transmission:</label>
        <select name="transmission">
            <option value="">All</option>
            <option value="Manual">Manual</option>
            <option value="Automatic">Automatic</option>
            <option value="CVT">CVT</option>
        </select>

        <label for="horsepower">Horsepower:</label>
        <select name="horsepower">
            <option value="0-450">All</option>
            <option value="0-150">0-150 HP</option>
            <option value="151-300">151-300 HP</option>
            <option value="301-450">301-450 HP</option>
        </select>

        <button type="submit">Apply Filters</button>
</form>

<!-- Compare popup window -->
<p class="warning-message">{{.CarData.Message}}</p>
{{if .CarData.IsPopup}}
<div class="popup">
    <form method="GET" action="/">
        <button type="submit" id="close-button">Close</button>
    </form>
    <table class="popup-table">
        {{$car1 := (index .CarData.CompareModels 0)}}
        {{$car2 := (index .CarData.CompareModels 1)}}
        <tr>
            <td class="compare-name">{{$car1.Name}}</td>
            <td class="compare-name">{{$car2.Name}}</td>
        </tr>
        <tr>
            <td>
                <img src="http://localhost:3000/api/images/{{$car1.Image}}" alt="{{$car1.Name}}" width="250">
            </td>
            <td>
                <img src="http://localhost:3000/api/images/{{$car2.Image}}" alt="{{$car2.Name}}" width="250">
            </td>
        </tr>
        <tr>
            <td>{{$car1.Year}}</td>
            <td>{{$car2.Year}}</td>
        </tr>
        <tr>
            <th>Engine</th>
            <td>
                {{$car1.Specifications.Engine}}
            </td>
            <td>
                {{$car2.Specifications.Engine}}
            </td>
        </tr>
        <tr>
            <td class="{{if CompareHorsepower $car1.Specifications.Horsepower $car2.Specifications.Horsepower}}
            better{{end}}">
                {{$car1.Specifications.Horsepower}}
            </td>
            <td class="{{if CompareHorsepower $car2.Specifications.Horsepower $car1.Specifications.Horsepower}}
            better{{end}}">
                {{$car2.Specifications.Horsepower}}
            </td>
        </tr>
        <tr>
            <td>
                {{$car1.Specifications.Transmission}}
            </td>
            <td>
                {{$car1.Specifications.Transmission}}
            </td>
        </tr>
        <tr>
            <td>
                {{$car1.Specifications.Drivetrain}}
            </td>
            <td>
                {{$car1.Specifications.Drivetrain}}
            </td>
        </tr>
        
    </table>
</div>
{{end}}


<form method="POST" action="/">
    <table>
        <tr>
            <th>Image</th>
            <th>Name</th>
            <th>Manufacturer</th>
            <th>Category</th>
            <th>Year</th>
        </tr>
        {{range .CarData.CarModels}}
        <tr class="container">
            <td>
                <input type="checkbox" name="option" value="{{.ID}}" class="checkbox">
                <details>
                    <summary>
                        <img src="http://localhost:3000/api/images/{{.Image}}" alt="{{.Name}} Image" width="150">
                    </summary>
                    <div class="hidden-content">
                        <strong>Specifications:</strong>
                        <ul>
                            <li>Engine: {{.Specifications.Engine}}</li>
                            <li>Horsepower: {{.Specifications.Horsepower}}</li>
                            <li>Transmission: {{.Specifications.Transmission}}</li>
                            <li>Drivetrain: {{.Specifications.Drivetrain}}</li>
                        </ul>
                    </div>
                </details>
            </td>
            <td>{{.Name}}</td>
            <td>
                <details>
                    <summary>
                        {{GetManufacturerData .ManufacturerID $.CarData "Name"}}
                    </summary>
                    <div class="hidden-content">
                        <strong>Info:</strong>
                        <ul>
                            <li>Country: {{GetManufacturerData .ManufacturerID $.CarData "Country"}}</li>
                            <li>Founding year: {{GetManufacturerData .ManufacturerID $.CarData "FoundingYear"}}</li>
                        </ul>
                    </div>
                </details>
            </td>
            <td>{{GetCategoryName .CategoryID $.CarData}}</td>
            <td>{{.Year}}</td>
        </tr>
        {{end}}
    </table>
    <button type="submit" id="submit-button">Compare</button>
</form>
</body>
</html>
